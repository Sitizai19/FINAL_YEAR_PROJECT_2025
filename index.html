<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
    <title>Catswell Pet Care</title>
    
  </head>
  <body>
    <nav>
      <div class="nav__header">
        <div class="nav__logo">
            <img src="assets/logo.png" alt="Pet Place Logo" class="logo-img">
        </div>
        <div class="nav__menu__btn" id="menu-btn">
          <i class="ri-menu-line"></i>
        </div>
      </div>
      <ul class="nav__links" id="nav-links">
        <li><a href="#home">Home</a></li>
        <li><a href="about.html">About</a></li>
        
        <li><a href="services.html">Services</a></li>
        <li class="nav__login-item">
          <div
            aria-label="User Login Button"
            tabindex="0"
            role="button"
            class="user-profile"
          >
            <div class="user-profile-inner">
              <svg
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
              >
                <g data-name="Layer 2" id="Layer_2">
                  <path
                    d="m15.626 11.769a6 6 0 1 0 -7.252 0 9.008 9.008 0 0 0 -5.374 8.231 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 9.008 9.008 0 0 0 -5.374-8.231zm-7.626-4.769a4 4 0 1 1 4 4 4 4 0 0 1 -4-4zm10 14h-12a1 1 0 0 1 -1-1 7 7 0 0 1 14 0 1 1 0 0 1 -1 1z"
                  ></path>
                </g>
              </svg>
              <p>Log In</p>
            </div>
          </div>
        </li>
      </ul>
    </nav>
    <header id="home">
      <div class="section__container header__container">
        <div class="header__content">
          <h4>Welcome</h4>
          <h1>Pet<br /><span>Care Services</span></h1>
          <h2>We love pets like you do :)</h2>
          <p>
            From routine check-ups to specialized treatments, we're here to
            ensure your pets lead happy, healthy lives.
          </p>
          <div class="header__btn">
            <button>
              Start Here!
              <span><i class="ri-arrow-right-line"></i></span>
            </button>
          </div>
        </div>
        <div class="header__image">
          <img
            src="assets/header-bg.png"
            alt="header-bg"
            class="header__image-bg"
          />
          <img src="assets/header.png" alt="header" />
        </div>
      </div>
      <div class="header__bottom"></div>
    </header>

    <section class="section__container intro__container">
      <p class="section__subheader">Intro</p>
      <h2 class="section__header">Get to know us more</h2>
      <div class="intro__grid">
        <div class="intro__card">
          <div class="intro__image">
            <img src="assets/intro-1.gif" alt="intro" />
          </div>
          <h4>Cat Hotel</h4>
          <p>
            Your catâ€™s home away from home, with personalized care during their stay.
          </p>
          <a href="#">Read More</a>
        </div>
        <div class="intro__card">
          <div class="intro__image">
            <img src="assets/intro-2.gif" alt="intro" />
          </div>
          <h4>Our Services</h4>
          <p>
            Affordable and reliable services designed to keep your cat comfortable while you're away.
          </p>
          <a href="#">Read More</a>
        </div>
        <div class="intro__card">
          <div class="intro__image">
            <img src="assets/intro-3.gif" alt="intro" />
          </div>
          <h4>Contact Us</h4>
          <p>
            Reach out to us for any inquiries or schedule an appointment for
            your pet's care.
          </p>
          <a href="#">Read More</a>
        </div>
      </div>
    </section>

    <section class="section__container about__container" id="about">
      <p class="section__subheader">About Us</p>
      <h2 class="section__header">What we can do for you</h2>
      <div class="about__row">
        <div class="about__image">
          <img src="assets/about-1.jpg" alt="about" />
        </div>
        <div class="about__content">
          <span><img src="assets/about-1-icon.gif" alt="about-icon" /></span>
          <h4>Let us help you keep your cat healthy and clean.</h4>
          <p>
            From bathing to styling, we offer professional grooming services to
            keep your pet looking and feeling their best.
          </p>
        </div>
      </div>
      <div class="about__row">
        <div class="about__image">
          <img src="assets/about-2.png" alt="about" />
        </div>
        <div class="about__content">
          <span><img src="assets/about-2-icon.gif" alt="about-icon" /></span>
          <h4>Caring personal will take care of your pet</h4>
          <p>
           Your pet will enjoy a luxurious stay with our compassionate and well-trained staff, who treat every cat like family while providing the utmost care and comfort.
          </p>
        </div>
      </div>
      <div class="about__row">
        <div class="about__image">
          <img src="assets/about-3.png" alt="about" />
        </div>
        <div class="about__content">
          <span><img src="assets/about-3-icon.gif" alt="about-icon" /></span>
          <h4>Let us groom your precious and loved pet</h4>
          <p>
            Our expert groomers are here to provide comprehensive care and grooming services to ensure your pet stays clean, healthy, and happy.
          </p>
        </div>
      </div>
    </section>

    <section class="product" id="store">
      <div class="section__container product__container">
        <p class="section__subheader">Products</p>
        <h2 class="section__header">Featured Pet Services</h2>
        <div class="product__grid">
          <div class="product__card">
            <img src="assets/product-1.jpeg" alt="product" />
            <h4>Cat Grooming Services</h4>
            <p>
              Complete grooming services to keep your cat clean and healthy.
            </p>
            <h3>Starting from RM20 Per session</h3>
            <a href="#">Book your slot now</a>
          </div>
          <div class="product__card">
            <img src="assets/product-2.jpeg" alt="product" />
            <h4>Cat Hotel stay</h4>
            <p>
              Safe, cozy, and relaxing stays for your cat while youâ€™re away.
            </p>
            <h3>Starting from RM35 Per Night</h3>
            <a href="#">Book your slot now</a>
          </div>
          <div class="product__card">
            <img src="assets/product-3.jpeg.jpeg" alt="product" />
            <h4>Our Package</h4>
            <p>
              Affordable care for your pet- includes bath, nail trim, ear cleaning, and brushing.
            </p>
            <h3>Starting from RM10 Per service</h3>
            <a href="#">Book your slot now</a>
          </div>
        </div>
      </div>
    </section>

    <section class="section__container service__container" id="service">
      <p class="section__subheader">Services</p>
      <h2 class="section__header">What we can do for you</h2>
      <div class="service__flex">
        <div class="service__card">
          <div>
            <img src="assets/service-1.png" alt="service" />
          </div>
          <p>Emergency Care</p>
        </div>
        
        
        <div class="service__card">
          <div>
            <img src="assets/service-4.png" alt="service" />
          </div>
          <p>Behavioral Consultation</p>
        </div>
        <div class="service__card">
          <div>
            <img src="assets/service-5.png" alt="service" />
          </div>
          <p>Pet Boarding Services</p>
        </div>
      </div>
    </section>

    <section class="client">
      <div class="section__container client__container">
        <p class="section__subheader">Testimonials</p>
        <h2 class="section__header">What people say about us</h2>
        
        <div class="swiper">
          
          <div class="swiper-wrapper">
            <!-- Slides -->
            <div class="swiper-slide">
              <div class="client__card">
                <div class="client__details">
                  <img src="assets/client-1.jpg" alt="client" />
                  <div>
                    <h4>Sarah Johnson</h4>
                    <h5>Graphic Designer</h5>
                  </div>
                </div>
                <p>
                  The care my dog received at Pet Doctor was exceptional. The
                  vets were attentive cared about my dog's well-being.
                </p>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="client__card">
                <div class="client__details">
                  <img src="assets/client-2.jpg" alt="client" />
                  <div>
                    <h4>Michael Adams</h4>
                    <h5>Software Engineer</h5>
                  </div>
                </div>
                <p>
                  Pet Doctor saved my cat during an emergency! Their quick
                  response and expertise made all the difference.
                </p>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="client__card">
                <div class="client__details">
                  <img src="assets/client-3.jpg" alt="client" />
                  <div>
                    <h4>Emily Martinez</h4>
                    <h5>Teacher</h5>
                  </div>
                </div>
                <p>
                  I trust Pet Doctor with all my pets. Their team is
                  professional, and they always go the extra mile for their
                  patients.
                </p>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="client__card">
                <div class="client__details">
                  <img src="assets/client-4.jpg" alt="client" />
                  <div>
                    <h4>Jason Lee</h4>
                    <h5>Marketing Specialist</h5>
                  </div>
                </div>
                <p>
                  The grooming services at Pet Doctor are fantastic! My pup
                  always comes back looking fresh and happy.
                </p>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="client__card">
                <div class="client__details">
                  <img src="assets/client-5.jpg" alt="client" />
                  <div>
                    <h4>David Thompson</h4>
                    <h5>Accountant</h5>
                  </div>
                </div>
                <p>
                  I've never seen a team so dedicated to animals. Pet Doctor is
                  my go-to clinic for all pet-related issues.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section__container instagram__container">
      <p>FOLLOW</p>
      <h2 class="section__header">Instagram</h2>
      <div class="instagram__grid">
        <img src="assets/instagram-1.png" alt="instagram" />
        <img src="assets/instagram-2.png" alt="instagram" />
        <img src="assets/instagram-3.png" alt="instagram" />
        <img src="assets/instagram-4.png" alt="instagram" />
      </div>
    </section>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
      <div class="modal__overlay" id="modalOverlay"></div>
      <div class="modal__content">
        <!-- Login Form -->
        <div class="form-container" id="loginForm">
          <!-- Close Button -->
          <button class="modal__close" id="modalClose">
            <i class="ri-close-line"></i>
          </button>
          
          <!-- Catswell Logo -->
          <div class="auth-logo">
            <img src="assets/logo.png" alt="Catswell Logo">
          </div>
          
          <!-- Error Message -->
          <div id="loginMessage" class="message error" style="display: none;">
            Firebase: Error (auth/invalid-credential).
          </div>
          
          <form class="form" id="loginFormElement">
            <input type="hidden" name="action" value="login">
            <div class="input-group">
              <label for="username">Email Address</label>
              <input type="email" name="username" id="username" placeholder="Enter your email" required autocomplete="email">
            </div>
            <div class="input-group">
              <label for="password">Password</label>
              <div class="password-input-container">
                <input type="password" name="password" id="password" placeholder="Enter Your password" required autocomplete="current-password">
                <button type="button" class="password-toggle" id="passwordToggle" onclick="togglePassword()">
                  <i class="ri-eye-off-line" id="passwordToggleIcon"></i>
                </button>
              </div>
              
            </div>
            <button type="submit" class="sign">Sign in</button>
          </form>
          
          <!-- Google Sign-In Button -->
          <div class="google-signin-container">
            <button type="button" class="google-signin-btn" onclick="signInWithGoogle()">
              <svg class="google-logo" width="18" height="18" viewBox="0 0 24 24">
                <path fill="#4285f4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34a853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#fbbc05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#ea4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
              </svg>
              Continue with Google
            </button>
          </div>
          
          <!-- Divider -->
          <div class="divider">
            <span>or</span>
          </div>
          
          <!-- Community Message -->
          <div class="social-message">
            <div class="line"></div>
            <p class="message">Be Part of Our Community Now!</p>
            <div class="line"></div>
          </div>
          
          
          <!-- User Manual trigger -->
          <div class="social-message" style="margin-top: 0.3rem;">
            <div class="line"></div>
            <p class="message"><button type="button" onclick="openUserManual()" style="background:#3b82f6;color:#fff;border:none;padding:6px 10px;border-radius:6px;cursor:pointer;">User Manual</button></p>
            <div class="line"></div>
          </div>

          <!-- Demo Accounts Section -->
          <div class="demo-accounts">
            <div class="social-message">
              <div class="line"></div>
              <p class="message">Demo Accounts</p>
              <div class="line"></div>
            </div>
            <ul class="demo-list">
              <li><span class="role">Admin:</span> <span class="cred">Use <a href="admin-login.html" style="font-weight: bold; color: inherit; text-decoration: underline;">Admin Login Page</a></span></li>
              <li><span class="role">User:</span> <span class="cred">user@example.com</span> â€¢ <span class="cred">user123</span></li>
            </ul>
          </div>
          <p class="signup">Don't have an account?
            <a rel="noopener noreferrer" href="#" class="" id="showSignup">Sign up</a>
          </p>
          
          
        </div>

        <!-- Sign Up Form -->
        <div class="form-container" id="signupForm" style="display: none;">
          <!-- Close Button -->
          <button class="modal__close" id="modalCloseSignup">
            <i class="ri-close-line"></i>
          </button>
          
          <!-- Catswell Logo -->
          <div class="auth-logo">
            <img src="assets/logo.png" alt="Catswell Logo">
          </div>
          
          <div id="signupMessage" class="message" style="display: none;"></div>
          <form class="form" id="signupFormElement">
            <input type="hidden" name="action" value="signup">
            <div class="input-group">
              <label for="firstname">First Name *</label>
              <input type="text" name="firstname" id="firstname" placeholder="Enter your first name" required autocomplete="given-name">
            </div>
            <div class="input-group">
              <label for="lastname">Last Name *</label>
              <input type="text" name="lastname" id="lastname" placeholder="Enter your last name" required autocomplete="family-name">
            </div>
            <div class="input-group">
              <label for="signup-email">Email Address *</label>
              <input type="email" name="email" id="signup-email" placeholder="Enter your email address" required title="Please enter a valid email address" autocomplete="email">
            </div>
            <div class="input-group">
              <label for="phone">Phone Number *</label>
              <input type="tel" name="phone" id="phone" placeholder="Enter your phone number" required title="Please enter a valid phone number" oninput="this.value = this.value.replace(/[^0-9+\-\s()]/g, '')" autocomplete="tel">
            </div>
            <div class="input-group">
              <label for="address">Address *</label>
              <input type="text" name="address" id="address" placeholder="Enter your address" required autocomplete="street-address">
            </div>
            <div class="input-group">
              <label for="signup-password">Password *</label>
              <div class="password-input-container">
                <input type="password" name="signup-password" id="signup-password" placeholder="Enter your password" required minlength="6" title="Password must be at least 6 characters" autocomplete="new-password">
                <button type="button" class="password-toggle" id="signupPasswordToggle" onclick="toggleSignupPassword()">
                  <i class="ri-eye-line" id="signupPasswordToggleIcon"></i>
                </button>
              </div>
            </div>
            <div class="input-group">
              <label for="confirm-password">Confirm Password *</label>
              <div class="password-input-container">
                <input type="password" name="confirm-password" id="confirm-password" placeholder="Confirm your password" required minlength="6" title="Password must be at least 6 characters" autocomplete="new-password">
                <button type="button" class="password-toggle" id="confirmPasswordToggle" onclick="toggleConfirmPassword()">
                  <i class="ri-eye-line" id="confirmPasswordToggleIcon"></i>
                </button>
              </div>
            </div>
            <button type="submit" class="sign">Sign up</button>
          </form>
          <div class="social-message">
            <div class="line"></div>
            <p class="message">Lets Go!</p>
            <div class="line"></div>
          </div>
          
          <p class="signup">Already have an account?
            <a rel="noopener noreferrer" href="#" class="" id="showLogin">Login</a>
          </p>
        </div>
      </div>
    </div>

    <!-- User Manual Mini Modal -->
    <div class="modal" id="userManualModal" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; align-items: center; justify-content: center; z-index: 10001;">
      <div class="modal__overlay" onclick="closeUserManual()" style="position:absolute; inset:0; background: rgba(0,0,0,0.45);"></div>
      <div class="modal__content" style="max-width:720px; width: calc(100% - 32px); padding:0; position: relative; z-index: 10002; background:#ffffff; background-color:#ffffff; border-radius:12px; box-shadow: 0 18px 40px rgba(0,0,0,0.25); overflow:hidden;">
        <style>
          /* Scoped styles for User Manual */
          #userManualModal .um-header{background:#6d0dcd ;color:#fff;padding:18px 20px;display:flex;align-items:center;gap:10px}
          #userManualModal .um-header h3{margin:0;font-size:20px;font-weight:700}
          #userManualModal .um-header p{margin:2px 0 0 0;opacity:.9;font-size:12px}
          #userManualModal .um-close{position:absolute;right:10px;top:10px;background:rgba(255,255,255,.2);border:none;color:#fff;border-radius:8px;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer}
          #userManualModal .um-body{padding:16px; position: relative;}
          #userManualModal .um-bg{position:absolute; inset:0; background:url('assets/usermanual_bg.png') center/cover no-repeat; opacity:0.25;}
          #userManualModal .um-inner{position:relative;}
          #userManualModal .um-tabs{display:flex;gap:8px;flex-wrap:wrap;margin:0 0 14px 0}
          #userManualModal .booking__action__btn.secondary{background:#f3f4f6;color:#374151;border:1px solid #e5e7eb;border-radius:9999px}
          #userManualModal .booking__action__btn.primary{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff;border:none;border-radius:9999px}
          #userManualModal .booking__action__btn:hover{filter:brightness(0.97)}
          #userManualModal .um-pane .um-card{background:rgba(255,255,255,0.9);border:1px solid #e5e7eb;border-radius:10px;padding:12px 14px;margin-bottom:10px;display:flex;gap:10px;align-items:flex-start}
          #userManualModal .um-icon{width:36px;height:36px;border-radius:8px;background:#eef2ff;display:flex;align-items:center;justify-content:center;color:#4f46e5;font-size:20px}
          #userManualModal .um-icon i{font-size:20px;display:inline-block;line-height:1;font-family:'remixicon' !important;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
          #userManualModal .um-card h4{margin:0 0 4px 0;font-size:14px;color:#111827}
          #userManualModal .um-card p{margin:0;color:#4b5563;font-size:13px;line-height:1.45}
          #userManualModal .um-footer{display:flex;justify-content:flex-end;gap:8px;padding:12px 16px;border-top:1px solid #f1f5f9;background:#fff}
        </style>
        <div class="um-header">
          <div style="flex:1;">
            <h3>User Manual</h3>
            <p>Quick help to get you started</p>
          </div>
          <button class="um-close" onclick="closeUserManual()"><i class="ri-close-line"></i></button>
        </div>
        <div class="um-body">
          <div class="um-bg"></div>
          <div class="um-inner">
          <div class="um-tabs booking__actions">
            <button class="booking__action__btn secondary" id="umTabGettingStarted" onclick="showUMTab('getting')"><i class="ri-rocket-2-line"></i> Getting Started</button>
            <button class="booking__action__btn secondary" id="umTabGuide" onclick="showUMTab('guide')"><i class="ri-calendar-check-line"></i> Booking Guide</button>
            <button class="booking__action__btn secondary" id="umTabFaq" onclick="showUMTab('faq')"><i class="ri-question-answer-line"></i> FAQ</button>
          </div>
          <div id="umPaneGetting" class="um-pane">
            <div class="um-card"><div class="um-icon"><i class="ri-user-add-line"></i></div><div><h4>Create your account</h4><p>Sign up or log in using your email or Google.</p></div></div>
            <div class="um-card"><div class="um-icon"><i class="ri-medal-line"></i></div><div><h4>Add your pet</h4><p>Go to Dashboard â†’ My Pets and add pet details and photo.</p></div></div>
            <div class="um-card"><div class="um-icon"><i class="ri-store-2-line"></i></div><div><h4>Explore services</h4><p>Browse grooming or hotel services, then pick a suitable slot.</p></div></div>
          </div>
          <div id="umPaneGuide" class="um-pane" style="display:none;">
            <div class="um-card"><div class="um-icon"><i class="ri-calendar-line"></i></div><div><h4>Pick date & time</h4><p>Choose your preferred date and time for the selected service.</p></div></div>
            <div class="um-card"><div class="um-icon"><i class="ri-file-list-line"></i></div><div><h4>Select pet(s)</h4><p>Choose the pet you added. You can include additional pets if supported.</p></div></div>
            <div class="um-card"><div class="um-icon"><i class="ri-mail-send-line"></i></div><div><h4>Confirm booking</h4><p>Submit to receive a confirmation email. View status in Dashboard â†’ Bookings.</p></div></div>
          </div>
          <div id="umPaneFaq" class="um-pane" style="display:none;">
            <div class="um-card"><div class="um-icon"><i class="ri-mail-close-line"></i></div><div><h4>Didnâ€™t get email?</h4><p>Check spam, then verify your email in Profile. You can also re-send from the booking view.</p></div></div>
            <div class="um-card"><div class="um-icon"><i class="ri-time-line"></i></div><div><h4>Change time?</h4><p>Contact support or cancel and rebook a new slot from your Dashboard.</p></div></div>
            <div class="um-card"><div class="um-icon"><i class="ri-question-line"></i></div><div><h4>Need help?</h4><p>Use the chat widget or email us via the Contact section in the footer.</p></div></div>
          </div>
          </div>
        </div>
        <div class="um-footer">
          <button class="booking__action__btn secondary" onclick="closeUserManual()">Close</button>
        </div>
      </div>
    </div>

    <script>
      function openUserManual(){
        const m = document.getElementById('userManualModal');
        if(!m) return; 
        m.style.display='flex'; 
        // Lock scroll only if login modal is not already open (which already locks scroll)
        const loginModal = document.getElementById('loginModal');
        const isLoginModalOpen = loginModal && (loginModal.style.display === 'flex' || loginModal.classList.contains('active') || window.getComputedStyle(loginModal).display === 'flex');
        if(!isLoginModalOpen) {
          document.body.style.overflow = 'hidden';
          document.body.classList.add('modal-open');
        }
        // default tab
        showUMTab('getting');
      }
      function closeUserManual(){
        const m = document.getElementById('userManualModal');
        if(!m) return; 
        m.style.display='none'; 
        // Only restore scroll if login modal is not open
        const loginModal = document.getElementById('loginModal');
        const isLoginModalOpen = loginModal && (loginModal.style.display === 'flex' || loginModal.classList.contains('active') || window.getComputedStyle(loginModal).display === 'flex');
        if(!isLoginModalOpen) {
          document.body.style.overflow = '';
          document.body.classList.remove('modal-open');
        }
      }
      function showUMTab(which){
        const panes = { getting: 'umPaneGetting', guide: 'umPaneGuide', faq: 'umPaneFaq' };
        Object.values(panes).forEach(id=>{ const el=document.getElementById(id); if(el){ el.style.display='none'; }});
        const activeId = panes[which]; const active = document.getElementById(activeId); if(active){ active.style.display='block'; }
        // button active styles
        const btns = { getting: 'umTabGettingStarted', guide: 'umTabGuide', faq: 'umTabFaq' };
        Object.values(btns).forEach(id=>{ const b=document.getElementById(id); if(b){ b.classList.remove('primary'); b.classList.add('secondary'); }});
        const ab = document.getElementById(btns[which]); if(ab){ ab.classList.remove('secondary'); ab.classList.add('primary'); }
      }
    </script>

    <footer id="contact">
      <div class="section__container footer__container">
        <div class="footer__col">
        <div class="footer__logo">
          <div class="footer__image">
            <img
              src="assets/blob.png"
              alt="footer-bg"
              class="footer__image-bg"
            />
            <img src="assets/catfooter.png" alt="cat-footer" class="footer__cat" />
            <img src="assets/footerlogo.png" alt="catswell-logo" class="footer__logo-img" />
          </div>
        </div>
        </div>
        <div class="footer__col">
          <h4>Company</h4>
          <ul class="footer__links">
            <li><a href="#">Home</a></li>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Services</a></li>
            
          </ul>
        </div>
        <div class="footer__col">
          <h4>Address</h4>
          <ul class="footer__links">
            <li><a href="#">Cheras, Kuala Lumpur, Malaysia</a></li>
          </ul>
          <br />
          <h4>Inquiries</h4>
          <ul class="footer__links">
            <li><a href="#">03-97896639</a></li>
            <li><a href="#">info@website.com</a></li>
          </ul>
        </div>
        <div class="footer__col">
          <h4>Newsletter</h4>
          <p>Stay updated with out latest news</p>
          <form action="/">
            <input type="text" placeholder="Your email" />
            <button class="btn">
              <i class="ri-arrow-right-line"></i>
            </button>
          </form>
          <br />
          <h4>Follow Us</h4>
          <ul class="footer__socials">
            <li>
              <a href="#"><i class="ri-facebook-fill"></i></a>
            </li>
            <li>
              <a href="#"><i class="ri-instagram-line"></i></a>
            </li>
            <li>
              <a href="#"><i class="ri-tiktok-fill"></i></a>
            </li>
          </ul>
        </div>
      </div>
      <div class="footer__bar">
        Â© 2025 Catswell Pet Care Management. All rights reserved.
      </div>
    </footer>

    <!-- Live Chat Widget -->
    <div class="chat-bubble" id="chatBubble">
      <i class="ri-chat-3-line"></i>
      <div class="chat-notification" id="chatNotification" style="display: none;">1</div>
    </div>

    <div class="chat-widget" id="chatWidget">
      <div class="chat-header">
        <div>
          <h3>Catswell Support</h3>
          <div class="chat-status">Online</div>
        </div>
        <button class="chat-close" id="chatClose">
          <i class="ri-close-line"></i>
        </button>
      </div>
      
      <div class="chat-messages" id="chatMessages">
        <div class="chat-message bot">
          <div class="message-bubble bot">
            Hello! ðŸ‘‹ Welcome to Catswell Pet Care. How can I help you today?
          </div>
        </div>
        <div class="message-time">Just now</div>
      </div>
      
      <div class="chat-input-area">
        <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." maxlength="500">
        <button class="chat-send" id="chatSend">
          <i class="ri-send-plane-line"></i>
        </button>
      </div>
    </div>

    <!-- Hamburger Menu Toggle -->
    <script>
      // Navigation functionality
      const menuBtn = document.getElementById('menu-btn');
      const navLinks = document.getElementById('nav-links');

      if (menuBtn && navLinks) {
        menuBtn.addEventListener('click', () => {
          navLinks.classList.toggle('nav__links--active');
        });
      }
    </script>

    <script src="https://unpkg.com/scrollreveal@4.0.9/dist/scrollreveal.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="main.js?v=20250113-clean-console"></script>
    
    
    <script>
      // Google Sign-In Configuration
      const GOOGLE_CLIENT_ID = '643080580151-606q4i9cg9ec2e2qjt1j5kn8202tkk9o.apps.googleusercontent.com';
      
      // Simple Google Sign-In Popup
      function signInWithGoogle() {
        // Simple OAuth popup
        const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?` + 
          `client_id=${GOOGLE_CLIENT_ID}&` +
          `redirect_uri=${encodeURIComponent('http://localhost/petcarewebapp/auth.php')}&` +
          `scope=openid email profile&` +
          `response_type=code&` +
          `prompt=select_account`;
        
        // Open popup
        const popup = window.open(authUrl, 'googleSignIn', 'width=500,height=600');
        
        if (!popup) {
          alert('Please allow popups for this site');
        }
      }
    </script>
    
    <!-- Authentication JavaScript -->
    <script>
      // Function to close login modal
      function closeLoginModal() {
        const loginModal = document.getElementById('loginModal');
        if (loginModal) {
          loginModal.style.display = 'none';
          loginModal.classList.remove('active');
          
          // Unlock body scroll
          document.body.classList.remove('modal-open');
          document.body.style.overflow = 'auto';
          
          // Properly reset form containers
          const loginForm = document.getElementById('loginForm');
          const signupForm = document.getElementById('signupForm');
          
          if (loginForm) {
            loginForm.style.display = 'block';
            loginForm.classList.remove('active');
          }
          if (signupForm) {
            signupForm.style.display = 'none';
            signupForm.classList.remove('active');
          }
          
          // Clear any error messages
          const loginMessage = document.getElementById('loginMessage');
          const signupMessage = document.getElementById('signupMessage');
          if (loginMessage) {
            loginMessage.style.display = 'none';
            loginMessage.textContent = '';
            loginMessage.className = 'message';
          }
          if (signupMessage) {
            signupMessage.style.display = 'none';
            signupMessage.textContent = '';
            signupMessage.className = 'message';
          }
          
          // Clear all form fields and reset validation states
          const loginFormElement = document.getElementById('loginFormElement');
          const signupFormElement = document.getElementById('signupFormElement');
          
          if (loginFormElement) {
            loginFormElement.reset();
            // Remove any validation classes
            const loginInputs = loginFormElement.querySelectorAll('input');
            loginInputs.forEach(input => {
              input.classList.remove('error', 'invalid');
              input.style.borderColor = '';
            });
          }
          
          if (signupFormElement) {
            signupFormElement.reset();
            // Remove any validation classes
            const signupInputs = signupFormElement.querySelectorAll('input');
            signupInputs.forEach(input => {
              input.classList.remove('error', 'invalid');
              input.style.borderColor = '';
            });
          }
        }
      }

      // Function to open login modal
      function openLoginModal() {
        const loginModal = document.getElementById('loginModal');
        if (loginModal) {
          // First, reset everything to ensure clean state
          const loginForm = document.getElementById('loginForm');
          const signupForm = document.getElementById('signupForm');
          const loginFormElement = document.getElementById('loginFormElement');
          const signupFormElement = document.getElementById('signupFormElement');
          
          // Reset forms and clear any validation states
          if (loginFormElement) {
            loginFormElement.reset();
            const loginInputs = loginFormElement.querySelectorAll('input');
            loginInputs.forEach(input => {
              input.classList.remove('error', 'invalid');
              input.style.borderColor = '';
            });
          }
          
          if (signupFormElement) {
            signupFormElement.reset();
            const signupInputs = signupFormElement.querySelectorAll('input');
            signupInputs.forEach(input => {
              input.classList.remove('error', 'invalid');
              input.style.borderColor = '';
            });
          }
          
          // Clear error messages
          const loginMessage = document.getElementById('loginMessage');
          const signupMessage = document.getElementById('signupMessage');
          if (loginMessage) {
            loginMessage.style.display = 'none';
            loginMessage.textContent = '';
            loginMessage.className = 'message';
          }
          if (signupMessage) {
            signupMessage.style.display = 'none';
            signupMessage.textContent = '';
            signupMessage.className = 'message';
          }
          
          // Ensure only login form is visible, hide signup form
          if (loginForm) {
            loginForm.style.display = 'block';
            loginForm.style.visibility = 'visible';
            loginForm.style.opacity = '1';
            loginForm.classList.add('active');
          }
          if (signupForm) {
            signupForm.style.display = 'none';
            signupForm.style.visibility = 'hidden';
            signupForm.style.opacity = '0';
            signupForm.classList.remove('active');
          }
          
          // Show modal
          loginModal.style.cssText = `
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            z-index: 9999 !important;
            visibility: visible !important;
            opacity: 1 !important;
            backdrop-filter: none !important;
            filter: none !important;
          `;
          
          // Ensure modal content is visible
          const modalContent = loginModal.querySelector('.modal__content');
          if (modalContent) {
            modalContent.style.cssText = `
              display: block !important;
              visibility: visible !important;
              opacity: 1 !important;
              z-index: 10000 !important;
              position: relative !important;
            `;
          }
          
          // Lock body scroll
          document.body.style.overflow = 'hidden';
          document.body.classList.add('modal-open');
          
          loginModal.classList.add('active');
        }
      }

      // Wait for DOM to be fully loaded
      document.addEventListener('DOMContentLoaded', function() {
      // Handle form switching between login and signup
        const showSignupLink = document.getElementById('showSignup');
        const showLoginLink = document.getElementById('showLogin');
        
        
        if (showSignupLink) {
          showSignupLink.addEventListener('click', function(e) {
        e.preventDefault();
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            
            if (loginForm) {
              loginForm.style.display = 'none';
            }
            if (signupForm) {
              signupForm.style.display = 'block';
              signupForm.style.visibility = 'visible';
              signupForm.style.opacity = '1';
            }
          });
        }
        
        if (showLoginLink) {
          showLoginLink.addEventListener('click', function(e) {
        e.preventDefault();
        document.getElementById('signupForm').style.display = 'none';
        document.getElementById('loginForm').style.display = 'block';
          });
        }
      });
      
      // Add event listeners for modal close functionality
      document.addEventListener('DOMContentLoaded', function() {
        // Close login modal when clicking overlay
        const modalOverlay = document.getElementById('modalOverlay');
        if (modalOverlay) {
          modalOverlay.addEventListener('click', closeLoginModal);
        }
        
        // Close login modal when clicking close buttons
        const modalClose = document.getElementById('modalClose');
        const modalCloseSignup = document.getElementById('modalCloseSignup');
        if (modalClose) {
          modalClose.addEventListener('click', closeLoginModal);
        }
        if (modalCloseSignup) {
          modalCloseSignup.addEventListener('click', closeLoginModal);
        }
        
        // Close modals when pressing Escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') {
            const loginModal = document.getElementById('loginModal');
            
            if (loginModal && loginModal.style.display !== 'none') {
              closeLoginModal();
            }
          }
        });
      });
      
      // Handle login form submission
      document.getElementById('loginFormElement').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const messageDiv = document.getElementById('loginMessage');
        
        try {
          const response = await fetch('auth.php', {
            method: 'POST',
            body: formData
          });
          
          let result;
          const raw = await response.text();
          try { result = JSON.parse(raw); } catch (_) {
            console.error('Non-JSON response from auth.php:', raw);
            throw new Error('Server returned an unexpected response. Check PHP errors in XAMPP logs.');
          }
          
          if (result.success) {
            messageDiv.textContent = result.message;
            messageDiv.className = 'message success';
            messageDiv.style.display = 'block';
            
            // Redirect to dashboard after 1 second
            setTimeout(() => {
              window.location.href = result.redirect || 'cust-dashboard.html';
            }, 1000);
          } else {
            messageDiv.textContent = result.message;
            messageDiv.className = 'message error';
            messageDiv.style.display = 'block';
          }
        } catch (error) {
          console.error('Login error:', error);
          messageDiv.textContent = 'An error occurred. Please try again.';
          messageDiv.className = 'message error';
          messageDiv.style.display = 'block';
        }
      });
      
      // Handle signup form submission
      document.getElementById('signupFormElement').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const messageDiv = document.getElementById('signupMessage');
        
        // Get form values
        const firstname = document.getElementById('firstname').value.trim();
        const lastname = document.getElementById('lastname').value.trim();
        const email = document.getElementById('signup-email').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const address = document.getElementById('address').value.trim();
        const password = document.getElementById('signup-password').value;
        const confirmPassword = document.getElementById('confirm-password').value;
        
        // Client-side validation
        if (!firstname || !lastname || !email || !phone || !address || !password || !confirmPassword) {
          messageDiv.textContent = 'All fields are required!';
          messageDiv.className = 'message error';
          messageDiv.style.display = 'block';
          return;
        }
        
        // Email validation
        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        if (!emailPattern.test(email)) {
          messageDiv.textContent = 'Please enter a valid email address!';
          messageDiv.className = 'message error';
          messageDiv.style.display = 'block';
          return;
        }
        
        // Phone validation (numbers only)
        const phonePattern = /^[0-9+\-\s()]+$/;
        if (!phonePattern.test(phone)) {
          messageDiv.textContent = 'Phone number can only contain numbers, +, -, spaces, and parentheses!';
          messageDiv.className = 'message error';
          messageDiv.style.display = 'block';
          return;
        }
        
        // Password validation
        if (password.length < 6) {
          messageDiv.textContent = 'Password must be at least 6 characters long!';
          messageDiv.className = 'message error';
          messageDiv.style.display = 'block';
          return;
        }
        
        // Confirm password validation
        if (password !== confirmPassword) {
          messageDiv.textContent = 'Passwords do not match!';
          messageDiv.className = 'message error';
          messageDiv.style.display = 'block';
          return;
        }
        
        // If validation passes, proceed with form submission
        const formData = new FormData(this);
        
        try {
          const response = await fetch('auth.php', {
            method: 'POST',
            body: formData
          });
          
          let result;
          const raw = await response.text();
          try { result = JSON.parse(raw); } catch (_) {
            console.error('Non-JSON response from auth.php:', raw);
            throw new Error('Server returned an unexpected response. Check PHP errors in XAMPP logs.');
          }
          
          if (result.success) {
            messageDiv.textContent = result.message;
            messageDiv.className = 'message success';
            messageDiv.style.display = 'block';
            
            // Redirect to dashboard after 1 second
            setTimeout(() => {
              window.location.href = result.redirect || 'cust-dashboard.html';
            }, 1000);
          } else {
            messageDiv.textContent = result.message;
            messageDiv.className = 'message error';
            messageDiv.style.display = 'block';
          }
        } catch (error) {
          console.error('Signup error:', error);
          messageDiv.textContent = 'An error occurred. Please try again.';
          messageDiv.className = 'message error';
          messageDiv.style.display = 'block';
        }
      });
      
      // Real-time phone number validation
      document.getElementById('phone').addEventListener('input', function(e) {
        // Remove any non-numeric characters except +, -, spaces, and parentheses
        this.value = this.value.replace(/[^0-9+\-\s()]/g, '');
      });
      
      // Real-time email validation
      document.getElementById('signup-email').addEventListener('blur', function(e) {
        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        if (this.value && !emailPattern.test(this.value)) {
          this.style.borderColor = '#dc2626';
          this.style.boxShadow = '0 0 0 1px rgba(239, 68, 68, 0.2)';
        } else if (this.value) {
          this.style.borderColor = '#16a34a';
          this.style.boxShadow = '0 0 0 1px rgba(34, 197, 94, 0.2)';
        }
      });
      
      // Real-time password confirmation validation
      document.getElementById('confirm-password').addEventListener('input', function(e) {
        const password = document.getElementById('signup-password').value;
        if (this.value && this.value !== password) {
          this.style.borderColor = '#dc2626';
          this.style.boxShadow = '0 0 0 1px rgba(239, 68, 68, 0.2)';
        } else if (this.value && this.value === password) {
          this.style.borderColor = '#16a34a';
          this.style.boxShadow = '0 0 0 1px rgba(34, 197, 94, 0.2)';
        }
      });
      
      // Password toggle functions
      function togglePassword() {
        const passwordInput = document.getElementById('password');
        const toggleIcon = document.getElementById('passwordToggleIcon');
        const toggleButton = document.getElementById('passwordToggle');
        
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          toggleIcon.className = 'ri-eye-off-line';
          toggleButton.classList.add('revealed');
          setTimeout(() => toggleButton.classList.remove('revealed'), 600);
        } else {
          passwordInput.type = 'password';
          toggleIcon.className = 'ri-eye-line';
        }
      }
      
      function toggleSignupPassword() {
        const passwordInput = document.getElementById('signup-password');
        const toggleIcon = document.getElementById('signupPasswordToggleIcon');
        const toggleButton = document.getElementById('signupPasswordToggle');
        
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          toggleIcon.className = 'ri-eye-off-line';
          toggleButton.classList.add('revealed');
          setTimeout(() => toggleButton.classList.remove('revealed'), 600);
        } else {
          passwordInput.type = 'password';
          toggleIcon.className = 'ri-eye-line';
        }
      }
      
      function toggleConfirmPassword() {
        const passwordInput = document.getElementById('confirm-password');
        const toggleIcon = document.getElementById('confirmPasswordToggleIcon');
        const toggleButton = document.getElementById('confirmPasswordToggle');
        
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          toggleIcon.className = 'ri-eye-off-line';
          toggleButton.classList.add('revealed');
          setTimeout(() => toggleButton.classList.remove('revealed'), 600);
        } else {
          passwordInput.type = 'password';
          toggleIcon.className = 'ri-eye-line';
        }
      }
    </script>
    
    <!-- Check login status and show Dashboard link -->
    <script>
      // Generate unique tab session ID (unique per browser tab)
      let tabSessionId = sessionStorage.getItem('tab_session_id');
      if (!tabSessionId) {
        tabSessionId = 'tab_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        sessionStorage.setItem('tab_session_id', tabSessionId);
      }
      
      // Check if user is logged in and show Dashboard link
      document.addEventListener('DOMContentLoaded', function() {
        // Check for session or login indicators
        fetch('auth.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
          body: 'action=check_login&tab_session_id=' + encodeURIComponent(tabSessionId)
        })
        .then(response => response.json())
        .then(data => {
          if (data.success && data.logged_in) {
            // Update login button to show "Welcome, [firstname]"
            const loginItem = document.querySelector('.nav__login-item');
            if (loginItem) {
              const firstName = data.first_name || 'User';
              loginItem.innerHTML = `
                <div aria-label="User Profile" tabindex="0" role="button" class="user-profile" style="width:auto;" onclick="window.location.href='cust-dashboard.html'">
                  <div class="user-profile-inner" style="width:auto; padding:0 12px; white-space:nowrap; max-width:none;">
                    <i class="ri-user-3-fill"></i>
                    <span>Welcome, ${firstName}</span>
                  </div>
                </div>
              `;
            }
          } else {
            // User is not logged in or session expired
            console.log('User not logged in or session expired:', data.message);
          }
        })
        .catch(error => {
          console.log('Login check failed:', error);
          // Keep default login button if check fails
        });
      });
    </script>
    
    <!-- Live Chat JavaScript -->
    <script>
      // Chat Widget Functionality
      document.addEventListener('DOMContentLoaded', function() {
        const chatBubble = document.getElementById('chatBubble');
        const chatWidget = document.getElementById('chatWidget');
        const chatClose = document.getElementById('chatClose');
        const chatInput = document.getElementById('chatInput');
        const chatSend = document.getElementById('chatSend');
        const chatMessages = document.getElementById('chatMessages');
        const chatNotification = document.getElementById('chatNotification');
        
        // Debug logging
        console.log('Chat bubble element:', chatBubble);
        console.log('Chat widget element:', chatWidget);
        
        if (!chatBubble) {
          console.error('Chat bubble element not found!');
          return;
        }
        
        if (!chatWidget) {
          console.error('Chat widget element not found!');
          return;
        }
        
        // Force show the chat bubble for debugging
        chatBubble.style.display = 'flex';
        chatBubble.style.visibility = 'visible';
        chatBubble.style.opacity = '1';
        chatBubble.style.position = 'fixed';
        chatBubble.style.bottom = '20px';
        chatBubble.style.right = '20px';
        chatBubble.style.width = '60px';
        chatBubble.style.height = '60px';
        chatBubble.style.zIndex = '9999';
        chatBubble.style.backgroundColor = '#8c6caf';
        chatBubble.style.borderRadius = '50%';
        chatBubble.style.cursor = 'pointer';
        chatBubble.style.boxShadow = '0 4px 20px rgba(140, 108, 175, 0.4)';
        
        // Debug computed styles
        const computedStyle = window.getComputedStyle(chatBubble);
        console.log('Chat bubble computed styles:', {
          display: computedStyle.display,
          visibility: computedStyle.visibility,
          opacity: computedStyle.opacity,
          position: computedStyle.position,
          bottom: computedStyle.bottom,
          right: computedStyle.right,
          zIndex: computedStyle.zIndex,
          width: computedStyle.width,
          height: computedStyle.height
        });
        
        let isOpen = false;
        let messageCount = 0;
        let currentConversationId = null;
        let pollInterval = null;
        let lastMessageId = 0; // Track last message ID to detect new messages
        
        // Sample responses for the bot
        const botResponses = [
          "Thank you for contacting Catswell! Our team will get back to you shortly.",
          "I can help you with information about our pet care services. What would you like to know?",
          "For booking appointments, please visit our services page or call us at 03-97896639.",
          "Our cat hotel services are available 24/7. Would you like to know more about our facilities?",
          "We offer grooming services starting from RM20. What type of service are you interested in?",
          "Our team is here to help! Is there anything specific about pet care you'd like to ask?",
          "You can also reach us via email at info@website.com for detailed inquiries.",
          "Thank you for choosing Catswell for your pet care needs! ðŸ±"
        ];
        
        // Open/close chat widget
        chatBubble.addEventListener('click', function() {
          console.log('Chat bubble clicked!');
          console.log('isOpen:', isOpen);
          console.log('chatWidget:', chatWidget);
          console.log('chatWidget classes:', chatWidget.classList);
          
          if (isOpen) {
            console.log('Closing chat...');
            closeChat();
          } else {
            console.log('Opening chat...');
            openChat();
          }
        });
        
        chatClose.addEventListener('click', closeChat);
        
        // Send message
        chatSend.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            sendMessage();
          }
        });
        
        function openChat() {
          console.log('openChat() called');
          console.log('Before - chatWidget classes:', chatWidget.classList);
          console.log('Before - chatWidget style:', chatWidget.style.cssText);
          
          isOpen = true;
          chatWidget.classList.add('active');
          chatBubble.classList.add('active');
          chatNotification.style.display = 'none';
          messageCount = 0;
          chatInput.focus();
          
          // Load existing messages if we have a conversation ID
          if (currentConversationId) {
            loadExistingMessages();
          }
          
          // Start polling for admin messages
          startPolling();
          
          console.log('After - chatWidget classes:', chatWidget.classList);
          console.log('After - chatWidget style:', chatWidget.style.cssText);
          console.log('isOpen is now:', isOpen);
        }
        
        function closeChat() {
          isOpen = false;
          chatWidget.classList.remove('active');
          chatBubble.classList.remove('active');
          
          // Stop polling when chat is closed
          stopPolling();
        }
        
        function sendMessage() {
          const message = chatInput.value.trim();
          if (!message) return;
          
          // Add user message to display immediately
          addMessage(message, 'user');
          chatInput.value = '';
          
          // Send message to server
          sendMessageToServer(message);
        }
        
        async function sendMessageToServer(messageText) {
          try {
            const formData = new FormData();
            formData.append('action', 'send_message');
            formData.append('sender_type', 'user');
            formData.append('message_text', messageText);
            formData.append('user_name', 'Anonymous User');
            formData.append('user_email', '');
            
            // Include conversation ID if we have one
            if (currentConversationId) {
              formData.append('conversation_id', currentConversationId);
            }
            
            const response = await fetch('chat_api.php', {
              method: 'POST',
              body: formData
            });
            
            const result = await response.json();
            
            if (result.success) {
              // Store conversation ID for future messages
              if (result.conversation_id) {
                currentConversationId = result.conversation_id;
                console.log('Conversation ID set:', currentConversationId);
              }
              
              // Update lastMessageId to track the user's message
              if (result.message_id) {
                lastMessageId = result.message_id;
                console.log('Last message ID updated to:', lastMessageId);
                console.log('Current conversation ID:', currentConversationId);
              }
              
              // Show admin response after a delay
              setTimeout(() => {
                addMessage('Thank you for your message! An admin will respond shortly.', 'bot');
              }, 1000);
              
              // Start polling for admin replies if chat is open
              if (isOpen) {
                startPolling();
              }
            } else {
              console.error('Failed to send message:', result.message);
              addMessage('Sorry, there was an error sending your message. Please try again.', 'bot');
            }
          } catch (error) {
            console.error('Error sending message:', error);
            addMessage('Sorry, there was an error sending your message. Please try again.', 'bot');
          }
        }
        
        function addMessage(text, sender) {
          const messageDiv = document.createElement('div');
          messageDiv.className = `chat-message ${sender}`;
          
          const bubbleDiv = document.createElement('div');
          bubbleDiv.className = `message-bubble ${sender}`;
          bubbleDiv.textContent = text;
          
          const timeDiv = document.createElement('div');
          timeDiv.className = 'message-time';
          timeDiv.textContent = getCurrentTime();
          
          messageDiv.appendChild(bubbleDiv);
          chatMessages.appendChild(messageDiv);
          chatMessages.appendChild(timeDiv);
          
          // Scroll to bottom
          chatMessages.scrollTop = chatMessages.scrollHeight;
          
          // Show notification if chat is closed and it's a bot message
          if (!isOpen && sender === 'bot') {
            messageCount++;
            chatNotification.textContent = messageCount;
            chatNotification.style.display = 'flex';
          }
        }
        
        function getCurrentTime() {
          const now = new Date();
          return now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }
        
        // Load existing messages when chat opens
        async function loadExistingMessages() {
          if (!currentConversationId) return;
          
          try {
            console.log('Loading existing messages for conversation:', currentConversationId);
            const response = await fetch(`chat_api.php?action=get_messages&conversation_id=${currentConversationId}`);
            const result = await response.json();
            
            if (result.success && result.messages) {
              console.log('Loaded existing messages:', result.messages);
              
              // Clear current messages and reload them
              chatMessages.innerHTML = '';
              
              // Add welcome message
              const welcomeDiv = document.createElement('div');
              welcomeDiv.className = 'chat-message bot';
              welcomeDiv.innerHTML = `
                <div class="message-bubble bot">
                  Hello! ðŸ‘‹ Welcome to Catswell Pet Care. How can I help you today?
                </div>
              `;
              chatMessages.appendChild(welcomeDiv);
              
              const welcomeTimeDiv = document.createElement('div');
              welcomeTimeDiv.className = 'message-time';
              welcomeTimeDiv.textContent = 'Just now';
              chatMessages.appendChild(welcomeTimeDiv);
              
              // Add existing messages
              result.messages.forEach(msg => {
                const sender = msg.sender_type === 'user' ? 'user' : 'bot';
                addMessage(msg.message_text, sender);
                
                // Update lastMessageId to the highest message ID
                lastMessageId = Math.max(lastMessageId, msg.id);
              });
              
              console.log('Last message ID set to:', lastMessageId);
            }
          } catch (error) {
            console.error('Error loading existing messages:', error);
          }
        }
        
        // Polling functions for admin messages
        function startPolling() {
          if (pollInterval) return; 
          
          console.log('Starting polling for admin messages...');
          pollInterval = setInterval(async () => {
            console.log('Polling tick - checking for new messages...');
            await checkForNewMessages();
          }, 3000); // Poll every 3 seconds
        }
        
        function stopPolling() {
          if (pollInterval) {
            console.log('Stopping polling...');
            clearInterval(pollInterval);
            pollInterval = null;
          }
        }
        
        async function checkForNewMessages() {
          if (!currentConversationId) {
            console.log('No conversation ID, skipping message check');
            return;
          }
          
          console.log('Checking for new messages in conversation:', currentConversationId);
          
          try {
            const response = await fetch(`chat_api.php?action=get_messages&conversation_id=${currentConversationId}`);
            const result = await response.json();
            
            console.log('Message check response:', result);
            
            if (result.success && result.messages) {
              // Check for new admin messages
              const newAdminMessages = result.messages.filter(msg => 
                msg.sender_type === 'admin' && msg.id > lastMessageId
              );
              
              console.log('All messages:', result.messages);
              console.log('Last message ID:', lastMessageId);
              console.log('New admin messages:', newAdminMessages);
              
              // Debug: Show each message details
              result.messages.forEach((msg, index) => {
                console.log(`Message ${index}:`, {
                  id: msg.id,
                  sender_type: msg.sender_type,
                  message_text: msg.message_text,
                  created_at: msg.created_at,
                  isHigherThanLast: msg.id > lastMessageId
                });
              });
              
              if (newAdminMessages.length > 0) {
                console.log('Found new admin messages:', newAdminMessages);
                
                // Add each new admin message
                newAdminMessages.forEach(msg => {
                  console.log('Adding admin message to chat:', msg.message_text);
                  addMessage(msg.message_text, 'bot');
                  lastMessageId = Math.max(lastMessageId, msg.id);
                  console.log('Updated lastMessageId to:', lastMessageId);
                });
                
                // Show notification if chat is closed
                if (!isOpen) {
                  messageCount += newAdminMessages.length;
                  chatNotification.textContent = messageCount;
                  chatNotification.style.display = 'flex';
                }
              } else {
                console.log('No new admin messages found');
              }
            }
          } catch (error) {
            console.error('Error checking for new messages:', error);
          }
        }
        
        
        setTimeout(() => {
          if (!isOpen && messageCount === 0) {
            addMessage("Hi there! ðŸ‘‹ Need help with our pet care services?", 'bot');
            messageCount++;
            chatNotification.textContent = messageCount;
            chatNotification.style.display = 'flex';
          }
        }, 10000);
      });
    </script>
    
  </body>
</html>